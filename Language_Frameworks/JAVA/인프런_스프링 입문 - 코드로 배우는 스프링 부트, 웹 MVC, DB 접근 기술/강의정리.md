# 프로젝트 환경 생성

## 프로젝트 생성

- https://start.spring.io 에서 초기 프로젝트를 만든다
  - 위에의 starter에서 프로젝트,springBoot, language, packaging 등을 선택해준다
  - project meradata를 설정해준다 - project name 이런 것들을 설정한다
  - dependencies는 사용 할 의존성들을 찾아서 선택한다
- maven , gradle 이란? 라이브러리, 빌드 라이프사이클까지 관해주는 퉁

  - 과거에는 maven많이 씀 요즘은 gradle로 넘어오는 추세이다.

- 자바를 실행할 때 intelliJ 최신 버전은 Gradle을 통해서 실행하는 것이 기본이다.
- preferences -> build,execution,deployment->build tools -> gradle

  - build and run using : gradle -> intelliJ IDE
  - Run tests using : gradle -> intelliJ IDE
  - intellij IDE에서 바로 실행하도록 하면 더 빠르다 최적화를 해주나?

- Gradle은 의존관계가 있는 라이브러리를 함께 다운로드한다.

- Q. 스프링 부트는 프로젝트 생성을 보통 어떻게 하나? 모든 스타트를 위의 사이트에서 하나?
  - Intellij 내장된 프로젝트 생성 방법
  - 템플릿 복사
  - spring cli등 있음.
  - start.spring.io는 개인 프로젝트에서 많이 쓴다고 함

## 라이브러리

### 스프링부트 라이브러리

- 위에 initialize에서 선택한 두 개의 라이브러리를 확인해보자

- spring-boot-starter-web

  - sprinf-boot-starter-tomcat
    - 톰켓 웹서버이다. 아주 예전에는 이 톰켓을 따로 설치하고 자바 코드를 여기에 밀어넣어야 했는데 요즘은 starter-web에 내장되어있다.
  - sprint-webmvc
    - 스프링 웹 MVC
    - MVC 패턴응로 웹 애플리케이션이 동작하도록 하는 라이브러리임
    - 웹 요청을 HTTP -> Controller -> Service(Model) -> 응답 이라는 흐름을 자동화함
    - @Controller, @RequestMapping과 같은 어노테이션으로 쉡게 웹 개발이 가능하다
  - spring-boot-starter-thymeleaf
    - 타임라프 템플릿 엔진(view)
    - HTML에 동적 데이터를 넣어서 완성된 HTML을 만들어주는 라이브러리이다.
  - spring-boot-starter(공통)
    - 스프링부트 + 스프링 코어 + 로킹
    - spring-boot
      - spring-core
    - spring-boot-starter-logging
      - 스프링부트 spring-boot startter에 logging 라이브러리가 있다.
        ![로그라이브러리](./1.png)
      - slf4는 인터페이스이다. 로깅 어댑터 같은 역할이다
      - logback은 실제 로깅 구현체이다. slf4를 실제로 구현한 라이브러리이다.
      - 성능도 빠르고 여러 지원이 있다. 사람들이 많이 쓰니까 스프링에서도 기본으로 사용하도록 만든것임

### 테스트 라이브러리

- spring-boot-starter-test
  - java에서 test 라이브러리로는 Junit을 많이 쓴다
    ![TEST 라이브러리](./2.png)
  - 핵심은 junit이고 assertj, mockito같은 것은 테스트를 편리하게 해주기 위한 도와주는 도구
  - junit: JAVA에서 주로 사용하는 테스트 프레임워크이다. 최근에 4->5로 넘어갔다
  - mpockito : 목 라이브러리
  - assertj : 테스트코드를 돔 더 편하게 작성하게 도와주는 라이브러리이다.
  - spring-test : 스프링 통합 테스트 지원

## View 환경 설정

- resource/static/index.html

  - 스프링부트가 제공하는 welcome page기능이다.
  - 여기에 넣어놓으면 welcome page가 된다.
  - https://docs.spring.io/spring-boot/reference/web/reactive.html#web.reactive.webflux.welcome-page
    ![웰컴페이지](./3.png)

- spring boot에 기능이 많아서 다 기억 못함. 찾아보는 능력이 중요함
- spring.io > project > springBoot > learn 에서 검색을 통해 찾아볼 수 있음

### thymeleaf 템플릿 엔진

    - html을 브라우저에 띄워주는 엔진

    - thymeleaf 공싱 사이트 https://www.thymeleaf.org/
    - 스프링 공식 튜토리얼  https://spring.io/guides/gs/serving-web-content
        - GetMapping annotation을 사용한 예제를 볼 수 있다
        - server side rendering 도구s Thmeleaf를 사용함을 볼 수 있다.
    - 스프링부트 Template Engine 메뉴얼
        - https://docs.spring.io/spring-boot/reference/web/servlet.html#web.servlet.spring-mvc.template-engines
        - Thymeleaf 뿐 아니라 FreeMarker, Mustache등 다른 렌덜이 엔진?을 사용하는 메뉴얼도 있다.
    - template engine을 사용하고 default configuration을 사용하면 src/main/recources/templates 에서 자동으로 template을 선택한다. 아래의 코드에서와 같이 return "hello"를 하면 src/main/recources/templates/hello.html을 찾는다
    ```java
        @Controller
        public class HelloController {
            @GetMapping("hello")
            public String hello(Model model){
                model.addAttribute("data","hello");
                return "hello";   // 이 hello는 hello template을 넘겨준다

            }
    }
    ```
    - 동작은 아래와 같다
    ![MVC동작환경](./4.png)
    - 컨트롤러에서 리턴 값으로 문자를 반환하면, 뷰 리졸버(viewResolver)가 화면을 찾아서 처리한다
    - 스프링부트 기본 viewName 매핑
    - resources:templates/ +{ViewName}+ .html

- 참고로 spring-boot-devtools 라이브러리를 추가하면 Html 파일을 컴파일만 해주면 서버 재시작 없이 view 파일 변경 가능함
  - build -> recompile
  - spring-boot-devtools란?
    - https://docs.spring.io/spring-boot/reference/using/devtools.html
    - 개발에 유용한 tools 모음인 것 같다
    - Automatic Restart, Logging Changes in Condition Evaluation 등등

## Build, 실행

- terminal로 이동
- ./gradlew build
- build/libs 의 jar파일 실행 -> 배포할 때는 이것만 넣음 된다
- java -jar hello-sprint-0.0.1-SNAPSHOT.jar
- 옛날에는 war를 만들어서 집어넣고 했어야 했다 지금은 굉장이 편리해짐
- ./gradlew clean build 하면 지우고 다시 빌드해줌
